'use client'\n\nimport { useEffect, useState } from 'react'\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'\nimport { Button } from '@/components/ui/button'\nimport { useDatabase } from '@/hooks/useDatabase'\nimport { LineChart, Line, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts'\nimport { FileText, Users, CheckCircle, AlertCircle } from 'lucide-react'\n\nconst mockChartData = [\n  { name: 'Jan', documents: 4, forms: 2 },\n  { name: 'Feb', documents: 3, forms: 2 },\n  { name: 'Mar', documents: 2, forms: 9 },\n  { name: 'Apr', documents: 3, forms: 8 },\n  { name: 'May', documents: 4, forms: 3 },\n  { name: 'Jun', documents: 5, forms: 4 },\n]\n\nexport function Dashboard() {\n  const { repos, isReady, error } = useDatabase()\n  const [stats, setStats] = useState({\n    totalUsers: 0,\n    totalDocuments: 0,\n    totalAddresses: 0,\n    totalForms: 0,\n  })\n  const [loading, setLoading] = useState(true)\n  const [dbError, setDbError] = useState<string | null>(null)\n\n  useEffect(() => {\n    const fetchStats = async () => {\n      if (!isReady) return\n\n      try {\n        setLoading(true)\n        setDbError(null)\n\n        const [usersCount, docsCount, addressCount, univCount] = await Promise.all([\n          repos.users.count().catch(() => 0),\n          repos.documents.count().catch(() => 0),\n          repos.address.count().catch(() => 0),\n          repos.university.count().catch(() => 0),\n        ])\n\n        setStats({\n          totalUsers: usersCount,\n          totalDocuments: docsCount,\n          totalAddresses: addressCount,\n          totalForms: univCount,\n        })\n      } catch (err) {\n        const errorMsg = err instanceof Error ? err.message : 'Failed to fetch database statistics'\n        setDbError(errorMsg)\n        console.error('Database error:', err)\n      } finally {\n        setLoading(false)\n      }\n    }\n\n    fetchStats()\n  }, [isReady, repos])\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Database Status */}\n      {error && (\n        <Card className=\"border-red-200 bg-red-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center space-x-2 text-red-600\">\n              <AlertCircle className=\"h-5 w-5\" />\n              <span>Database initialization error: {error.message}</span>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {dbError && (\n        <Card className=\"border-yellow-200 bg-yellow-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center space-x-2 text-yellow-600\">\n              <AlertCircle className=\"h-5 w-5\" />\n              <span>Database connection warning: {dbError}</span>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {isReady && (\n        <Card className=\"border-green-200 bg-green-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center space-x-2 text-green-600\">\n              <CheckCircle className=\"h-5 w-5\" />\n              <span>Database is ready</span>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Statistics Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-gray-600\">Total Users</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center space-x-2\">\n              <Users className=\"h-8 w-8 text-blue-600\" />\n              <span className=\"text-3xl font-bold\">{loading ? '-' : stats.totalUsers}</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-gray-600\">Documents</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center space-x-2\">\n              <FileText className=\"h-8 w-8 text-green-600\" />\n              <span className=\"text-3xl font-bold\">{loading ? '-' : stats.totalDocuments}</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-gray-600\">Addresses</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center space-x-2\">\n              <FileText className=\"h-8 w-8 text-purple-600\" />\n              <span className=\"text-3xl font-bold\">{loading ? '-' : stats.totalAddresses}</span>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-sm font-medium text-gray-600\">Forms</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"flex items-center space-x-2\">\n              <FileText className=\"h-8 w-8 text-orange-600\" />\n              <span className=\"text-3xl font-bold\">{loading ? '-' : stats.totalForms}</span>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Charts */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        <Card>\n          <CardHeader>\n            <CardTitle>Activity Trend</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <LineChart data={mockChartData}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis dataKey=\"name\" />\n                <YAxis />\n                <Tooltip />\n                <Legend />\n                <Line type=\"monotone\" dataKey=\"documents\" stroke=\"#3b82f6\" />\n                <Line type=\"monotone\" dataKey=\"forms\" stroke=\"#10b981\" />\n              </LineChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n\n        <Card>\n          <CardHeader>\n            <CardTitle>Monthly Breakdown</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <BarChart data={mockChartData}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis dataKey=\"name\" />\n                <YAxis />\n                <Tooltip />\n                <Legend />\n                <Bar dataKey=\"documents\" fill=\"#3b82f6\" />\n                <Bar dataKey=\"forms\" fill=\"#10b981\" />\n              </BarChart>\n            </ResponsiveContainer>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Action Buttons */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Quick Actions</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-2\">\n          <div className=\"flex flex-wrap gap-2\">\n            <Button onClick={() => repos.users.getAll().then(() => alert('Fetched all users'))}>\n              Test: Get All Users\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={() => repos.documents.count().then(count => alert(`Total documents: ${count}`))}\n            >\n              Test: Count Documents\n            </Button>\n            <Button\n              variant=\"outline\"\n              onClick={() => {\n                console.log('Repositories:', repos)\n                alert('Check console for repos')\n              }}\n            >\n              Debug: Log Repos\n            </Button>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  )\n}\n"